<html>
    <head>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/geojson2svg/1.0.2/geojson2svg.min.js"></script>
        <script src="http://www.amcharts.com/lib/3/ammap.js"></script>
        <script src="http://www.amcharts.com/lib/3/themes/light.js"></script>
        
        <script src="mapdata.js"></script>
        <script type="text/javascript">           
            $(document).ready(function () {
                AmCharts.parseGeoJSON = function(geojson, fieldMap) {
                    
                    // init field map
                    if (typeof(fieldMap) !== "object")
                        fieldMap = {};
                    
                    // init calibration
                    /*var bounds = {
                        "left": -180,
                        "bottom": -90,
                        "right": 180,
                        "top": 90
                    };*/
                    var bounds = {
                        "left": 32,
                        "bottom": -82,
                        "right": 35,
                        "top": -85
                    };
                    
                    // init empty map
                    var mapVar = {
                        "svg": {
                            "defs": {
                                "amcharts:ammap": {
                                "projection":"mercator",
                                "leftLongitude":"-180",
                                "topLatitude":"90",
                                "rightLongitude":"180",
                                "bottomLatitude":"-90"
                                }   
                            },
                            "g":{
                                "path":[]
                            }
                        }
                    };

                    
                    // convert GeoJSON to SVG paths
                    var converter = geojson2svg({
                        "output": "svg",
                        "explode": false,
                        "attributes": {"class": "land"},
                        "mapExtent": bounds,
                        "viewportSize": {
                        "width": 800,
                        "height": 800
                        }
                    });

                    var svg = converter.convert(geojson, {});
                    
                    // parse each path into JavaScript Maps data structure
                    for(var i = 0; i < svg.length; i++) {
                        var path = svg[i];
                        var attrs = path.match(/\w+=".*?"/g);
                        var area = {};
                        for(var x = 0; x < attrs.length; x++) {
                            var parts = attrs[x].replace(/"/g, '').split("=");
                            var key = fieldMap[parts[0]] || parts[0];
                            area[key] = parts[1];
                        }
                        area['title'] = area.id;
                        mapVar.svg.g.path.push(area);
                    }
                    
                    console.log(mapVar);
                    return mapVar;
                }
                

                var getMapObject = function (geodata) {
                    let data = AmCharts.parseGeoJSON(geodata);

                    return {
                        type: 'map',
                        theme: 'light',
                        dataProvider: {
                            mapVar: data,
                            getAreasFromMap: true
                        },
                        areasSettings: {
                            autoZoom: true,
                            balloonText: '[[title]]',
                            selectedColor: '#CC0000'
                        }
                    };
                };

                var map = AmCharts.makeChart("chartdiv", getMapObject(mapdata));
            });          
        </script>
    </head>
    <body>
        <div id="chartdiv" style="width: 1024px; height: 768px"></div>
    </body>
</html>
    